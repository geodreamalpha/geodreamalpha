#version: 2.1
#general:
#  working_directory: ~/project/mobile/companion_app_project/
#  build_dir: ~/project/mobile/companion_app_project/
  
#orbs:
# android: circleci/android@0.2.0

#jobs:
# build:
#   executor: android/android

#   steps:
#     - checkout
#     - run:
#         command: ./gradlew build

version: 2.1

general:
  working_directory: ~/project/mobile/companion_app_project/
  build_dir: ~/project/mobile/companion_app_project/
orbs:
  android: circleci/android@1.0.3

jobs:
  test:
    executor:
      name: android/android-machine
      resource-class: large
    steps:
      - checkout
      - run: "ls -l"
      - run: "cd mobile"
      - run: "touch testing_dir_mobile.txt"
      - run: "ls -l"
      - android/create-avd:
          avd-name: myavd
          install: true
          system-image: system-images;android-29;default;x86
      - android/start-emulator:
          avd-name: myavd
          no-window: true
          restore-gradle-cache-prefix: v1a
      - android/run-tests
      - android/save-gradle-cache:
          cache-prefix: v1a
workflows:
  test:
    jobs:
      - test
